# Practical 1

## Part A: Introduction to Linux

1. Nearly all commands in linux are held in a file similar to the shell script you looked at above. The type command shows where that file is. What output does `$ type less` give? Change into that directory, can you find the file corresponding to the less command? What about the other commands we have seen, are they in the same directory? If not where are they?

    > less is /usr/bin/less
    
    Command `less` is a program at the path `/usr/bin/less`.
    
    Most of the commands used are in `/usr/bin/`

2. How many files do you have ending in `.txt` in your home directory? The `wc` command may well be useful for this, especially with the `â€“l` flag, so first take a look at `man wc`

    Use command `ls ~/*.txt | wc -l`.

3. How many files do you have ending in *.txt in all your directories?

    Use command `find . -name "*.txt" | wc -l`.

4. Using an editor create a file containing a list of names with some duplicates as described above. Experiment with the sort and uniq commands to see how this works. How in one command might one count how many unique names you have in the file?

    `cat names.txt | sort | uniq | wc -l` gives the number of unique names in `names.txt`.

## Part B: Compililng and Batch Systems

### Hello World

Output:
> Hello World

Use `icc hello_world.c -o hello` to generate an executable named `hello`.

### Makefiles

2. Compiled with `icc gs_opt.c array_alloc.c timer.c -o gs`

    Output:
    > Maximum error in orthonormalisation for MGS :   0.0000000000002363  
    > Time for MGS :   10.5097  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000041  
    > Time for ICGS:   40.2016

3. Compiled with `make`

    `-O0` output:
    > Maximum error in orthonormalisation for MGS :   0.0000000000004705  
    > Time for MGS :   88.6817  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000039  
    > Time for ICGS:  135.4011

4. Object files: `array_alloc.o`, `gs_opt.o`, `timer.o`. Each object file corresponds to the `.c` file with the same name.

5. Only `timer.c` is recompiled rather than all `.c` files being recompiled.

6. Running the executable generated by `make` is much slower.

7. Optimised results

    `-O1` output:

    > Maximum error in orthonormalisation for MGS :   0.0000000000004705  
    > Time for MGS :   17.9992  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000039  
    > Time for ICGS:   35.1016

    `-O2` output:

    > Maximum error in orthonormalisation for MGS :   0.0000000000002363  
    > Time for MGS :   14.3042  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000041  
    > Time for ICGS:   32.2883

    `-O3` output:

    > Maximum error in orthonormalisation for MGS :   0.0000000000002363  
    > Time for MGS :   12.7041  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000041  
    > Time for ICGS:   38.0973

8. With `-O1` optimisation flag set, the calculation is much faster. The `-O3` results are close to the speed of the first run compiled using `icc`.

### Batch Systems

1. This script is used to submit a job to the supercomputer.
    - The first few lines commented are used to describe the job and specify the resources needed.
    - `rm -f in` ensures there is no file called `in` in the current directory.
    - `echo 1000 >   in` and `echo 1000 >>  in` writes the inputs to the temporary file `in`.
    - `./gs < in` runs the program `gs` using the inputs in the `in` file.
    - `rm -f in` removes the temporary file `in`.

2. Running `sbatch script.sl`:
    > sbatch: GPU gres requested, checking settings/requirements...  
    > Submitted batch job 2928515

3. Job number is 2928515

4. Output from file `slurm-2928515.out`
    > Order of Vectors?  
    > Number of Vectors?  
    > Maximum error in orthonormalisation for MGS :   0.0000000000002363  
    > Time for MGS :    0.5753  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000041  
    > Time for ICGS:    1.8896

    This is `-O1` result.

5. Other optimisation levels

    `-O0` result:
    > Order of Vectors?  
    > Number of Vectors?  
    > Maximum error in orthonormalisation for MGS :   0.0000000000004705  
    > Time for MGS :    3.2213  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000039  
    > Time for ICGS:    6.8481

    `-O2` result:
    > Order of Vectors?  
    > Number of Vectors?  
    > Maximum error in orthonormalisation for MGS :   0.0000000000002363  
    > Time for MGS :    0.5786  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000041  
    > Time for ICGS:    1.9061


    `-O3` result:
    > Order of Vectors?  
    > Number of Vectors?  
    > Maximum error in orthonormalisation for MGS :   0.0000000000002363  
    > Time for MGS :    0.4433  
    > Maximum error in orthonormalisation for ICGS:   0.0000000000000041  
    > Time for ICGS:    2.0457

    There is not much difference between `-O1`, `-O2` and `-O3`.

6. Use `-o <filename>` or `--output=<filename>`option.

    E.g. `sbatch --output=myoutput.txt script.sl`